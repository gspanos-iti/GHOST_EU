#!/usr/bin/make -f
# See debhelper(7) (uncomment to enable)
# output every command that modifies files on the build system.
#export DH_VERBOSE = 1

export PYBUILD_NAME=ghost-te-dc

DESTDIR_PYTHON2=$(CURDIR)/debian/python-ghost-te-dc
DESTDIR_PYTHON3=$(CURDIR)/debian/python3-ghost-te-dc

%:
	dh $@ --with python2,python3 --buildsystem=pybuild

override_dh_auto_configure:
	dh_auto_configure

	cp -v "$(CURDIR)/debian/ghost-te-dc.service" "$(CURDIR)/debian/python-ghost-te-dc.service"
	cp -v "$(CURDIR)/debian/ghost-te-dc.service" "$(CURDIR)/debian/python3-ghost-te-dc.service"

override_dh_auto_install:
	dh_auto_install

	mkdir "$(DESTDIR_PYTHON2)/etc/" "$(DESTDIR_PYTHON2)/etc/ghost/"
	cp -v "$(CURDIR)/te_dc.ini" "$(DESTDIR_PYTHON2)/etc/ghost/te_dc.ini"
	mkdir "$(DESTDIR_PYTHON2)/usr/bin/"
	install -m 755 -T "$(CURDIR)/ghost-te-dc.py" "$(DESTDIR_PYTHON2)/usr/bin/ghost-te-dc.py"

	mkdir "$(DESTDIR_PYTHON3)/etc/" "$(DESTDIR_PYTHON3)/etc/ghost/"
	cp -v "$(CURDIR)/te_dc.ini" "$(DESTDIR_PYTHON3)/etc/ghost/te_dc.ini"
	mkdir "$(DESTDIR_PYTHON3)/usr/bin/"
	install -m 755 -T "$(CURDIR)/ghost-te-dc.py" "$(DESTDIR_PYTHON3)/usr/bin/ghost-te-dc.py"